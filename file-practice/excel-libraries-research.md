# JVM 엑셀 라이브러리 조사 결과

## 요구사항 분석
- JVM 환경에서 엑셀 파일을 생성하고 다운로드하는 기능이 필요합니다.
- 사용자가 동적으로 열을 선택하여 엑셀 파일을 생성할 수 있어야 합니다.
- 여러 시트를 포함하는 엑셀 파일을 생성해야 합니다.

## 후보 라이브러리

### 1. Apache POI
- **개요**: Apache 재단에서 개발한 가장 널리 사용되는 Java 라이브러리입니다. Microsoft Office 형식을 읽고 쓰는 기능을 제공합니다.
- **장점**:
    - `.xls` (HSSF)와 `.xlsx` (XSSF) 형식을 모두 지원합니다.
    - 매우 풍부한 기능(스타일링, 수식, 차트, 하이퍼링크 등)을 제공하여 복잡한 엑셀 파일을 만들 수 있습니다.
    - 거대한 커뮤니티와 방대한 레퍼런스를 보유하고 있어 문제 해결에 용이합니다.
    - 지속적으로 업데이트가 이루어지고 있습니다.
- **단점**:
    - 다른 라이브러리에 비해 API가 다소 복잡하게 느껴질 수 있습니다.
    - 대용량 데이터를 처리할 때 메모리 사용량이 많아 `OutOfMemoryError`가 발생할 수 있습니다. (이를 해결하기 위해 스트리밍 방식의 `SXSSF`를 제공하지만, 사용법이 더 복잡합니다.)

### 2. EasyExcel
- **개요**: 중국의 Alibaba에서 개발한 라이브러리로, 대용량 엑셀 데이터 처리에 특화되어 있습니다.
- **장점**:
    - Apache POI에 비해 훨씬 적은 메모리를 사용하여 대용량 데이터를 빠르게 읽고 쓸 수 있습니다.
    - 어노테이션 기반의 간단한 API를 제공하여 사용법이 매우 편리합니다.
    - 활발하게 유지보수되고 있습니다.
- **단점**:
    - Apache POI만큼 다양한 커스터마이징 기능(예: 복잡한 스타일링, 차트 등)을 지원하지는 않습니다.

### 3. JExcelAPI (JXL)
- **개요**: 과거에 많이 사용되었던 라이브러리입니다.
- **장점**:
    - API가 비교적 간단합니다.
- **단점**:
    - **`.xls` 형식만 지원**하며, 최신 `.xlsx` 형식은 지원하지 않습니다.
    - 2009년 이후로 업데이트가 중단되어 **더 이상 유지보수되지 않습니다.** (치명적인 단점)

## 결론
- **JExcelAPI (JXL)**는 `.xlsx` 미지원 및 유지보수 중단 문제로 후보에서 제외합니다.
- **EasyExcel**은 대용량 데이터 처리 성능과 편리한 API가 큰 장점이지만, 요구사항인 '동적 열 선택' 기능을 구현할 때 유연성이 다소 떨어질 수 있고, 복잡한 커스터마이징이 어려울 수 있습니다.
- **Apache POI**는 메모리 사용량에 대한 단점이 있지만, 가장 표준적이고 안정적이며, '동적 열 선택'과 같이 유연하고 복잡한 요구사항을 처리하기에 가장 적합합니다. 기능의 풍부함과 성숙도를 고려할 때 현재 프로젝트에 가장 적합한 라이브러리로 판단됩니다.

**최종 선택: Apache POI**

- 이유: 다양한 기능을 안정적으로 지원하며, 동적인 엑셀 생성을 포함한 복잡한 요구사항에 가장 유연하게 대처할 수 있습니다. 만약 향후 대용량 데이터 처리 시 성능 문제가 발생한다면, 그 때 EasyExcel로의 전환을 고려해볼 수 있습니다.
